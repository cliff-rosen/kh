 Stage 1: Update Data Models ✓ (Start here)

  Goal: New schema without breaking existing code

  Changes:
  - Add new Concept model to schemas/retrieval_config.py
  - Keep old RetrievalGroup temporarily (parallel systems)
  - Update RetrievalConfig to support both (migration path)

  Deliverables:
  - Concept model with entity_pattern, vocabulary_terms, volume tracking
  - Helper methods for coverage checking
  - Schema validation

  Duration: 1-2 hours

  ---
  Stage 2: Concept Proposal Service

  Goal: LLM generates concepts from semantic space

  Changes:
  - New service: ConceptProposalService
  - LLM prompt: analyzes entities/relationships → proposes concepts
  - Returns concept list with entity patterns and rationale

  Deliverables:
  - Service with propose_concepts(semantic_space) method
  - Endpoint: POST /api/research-streams/{id}/retrieval/propose-concepts
  - Returns list of proposed concepts with entity patterns

  Duration: 2-3 hours

  ---
  Stage 3: Volume Estimation & Refinement

  Goal: Test concepts and refine based on volume

  Changes:
  - Add volume testing to concepts (uses existing PubMed count endpoint)
  - LLM refinement suggestions based on volume
  - Service to refine concept (split, merge, generalize, specialize)

  Deliverables:
  - Volume estimation for concepts
  - Refinement suggestions from LLM
  - Endpoint for refinement operations

  Duration: 2-3 hours

  ---
  Stage 4: Query Generation (from concepts)

  Goal: Generate PubMed queries from entity patterns

  Changes:
  - Update query generation to use entity patterns + vocabulary
  - LLM maps concept pattern → boolean query
  - Vocabulary expansion per entity

  Deliverables:
  - Query generation from concept patterns
  - Endpoint: POST /api/research-streams/{id}/concepts/{concept_id}/generate-query

  Duration: 2 hours

  ---
  Stage 5: UI - Concept Workflow

  Goal: Replace group wizard with concept workflow

  Changes:
  - New wizard phase: "Concept Decomposition"
  - Show concepts grouped by topic they cover
  - Volume indicators and refinement UI
  - Test individual concepts

  Deliverables:
  - Concept list view (grouped by topics covered)
  - Volume badges (too broad/appropriate/too narrow)
  - Refinement buttons (split, merge, adjust)

  Duration: 4-5 hours

  ---
  Stage 6: Pipeline Execution

  Goal: Execute concept-based queries

  Changes:
  - Update pipeline to iterate over concepts (not groups)
  - Track articles by concept_id
  - Apply filters per concept

  Deliverables:
  - Pipeline executes concept queries
  - WIP articles tagged with concept_id
  - Coverage reporting

  Duration: 2-3 hours

  ---
  Stage 7: Migration & Cleanup

  Goal: Remove old group-based system

  Changes:
  - Remove RetrievalGroup code
  - Remove group-based endpoints
  - Update all references

  Deliverables:
  - Clean codebase with only concept-based system

  Duration: 2 hours

  ---
  Start with Stage 1?

  I'll create the new Concept model with all the fields from the framework:
  - entity_pattern
  - vocabulary_terms
  - volume tracking
  - exclusions
  - coverage mapping